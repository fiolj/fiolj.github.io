

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fix emit/face/file command &mdash; SPARTA 7 May 2020 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/rtd_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SPARTA
          

          
          </a>

          
            
            
              <div class="version">
                7 May 2020
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Section_intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_start.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_commands.html">3. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_packages.html">4. Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_accelerate.html">5. Accelerating SPARTA performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_howto.html">6. How-to discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_example.html">7. Example problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_perf.html">8. Performance &amp; scalability</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_tools.html">9. Additional tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_modify.html">10. Modifying &amp; extending SPARTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_python.html">11. Python interface to SPARTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_errors.html">12. Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_history.html">13. Future and history</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SPARTA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>fix emit/face/file command</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/fix_emit_face_file.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fix-emit-face-file-command">
<span id="command-fix-emit-face-file"></span><h1>fix emit/face/file command<a class="headerlink" href="#fix-emit-face-file-command" title="Permalink to this headline">¶</a></h1>
<p><strong>Syntax:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span> <span class="n">ID</span> <span class="n">emit</span><span class="o">/</span><span class="n">face</span><span class="o">/</span><span class="n">file</span> <span class="n">mix</span><span class="o">-</span><span class="n">ID</span> <span class="n">face</span> <span class="n">filename</span> <span class="n">boundary</span><span class="o">-</span><span class="n">ID</span> <span class="n">keyword</span> <span class="n">value</span> <span class="o">...</span>
</pre></div>
</div>
<ul>
<li><p>ID is documented in <a class="reference external" href="fix.html">fix</a> command</p></li>
<li><p>emit/face/file = style name of this fix command</p></li>
<li><p>mix-ID = ID of mixture to use when creating particles</p></li>
<li><p>face = <em>xlo</em> or <em>xhi</em> or <em>ylo</em> or <em>yhi</em> or <em>zlo</em> or <em>zhi</em></p></li>
<li><p>filename = input data file with boundary values for the emission</p></li>
<li><p>boundary-ID = section of data file to read</p></li>
<li><p>zero or more keyword/value pairs may be appended</p></li>
<li><p>keyword = <em>frac</em> or <em>nevery</em> or <em>perspecies</em> or <em>region</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">frac</span> <span class="n">value</span> <span class="o">=</span> <span class="n">fraction</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="n">to</span> <span class="mf">1.0</span> <span class="n">fraction</span> <span class="n">of</span> <span class="n">particles</span> <span class="n">to</span> <span class="n">insert</span>
<span class="n">nevery</span> <span class="n">value</span> <span class="o">=</span> <span class="n">Nstep</span> <span class="o">=</span> <span class="n">insert</span> <span class="n">every</span> <span class="n">this</span> <span class="n">many</span> <span class="n">timesteps</span>
<span class="n">perspecies</span> <span class="n">value</span> <span class="o">=</span> <span class="n">yes</span> <span class="ow">or</span> <span class="n">no</span>
<span class="n">region</span> <span class="n">value</span> <span class="o">=</span> <span class="n">region</span><span class="o">-</span><span class="n">ID</span>
</pre></div>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span> <span class="ow">in</span> <span class="n">emit</span><span class="o">/</span><span class="n">face</span><span class="o">/</span><span class="n">file</span> <span class="n">air</span> <span class="n">xlo</span> <span class="nb">input</span><span class="o">.</span><span class="n">data</span> <span class="n">xlo</span>
<span class="n">fix</span> <span class="ow">in</span> <span class="n">emit</span><span class="o">/</span><span class="n">face</span><span class="o">/</span><span class="n">file</span> <span class="n">mymix</span> <span class="n">ylo</span> <span class="n">file</span><span class="o">.</span><span class="n">txt</span> <span class="n">oneface</span> <span class="n">frac</span> <span class="mf">0.1</span> <span class="n">nevery</span> <span class="mi">10</span>
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>Emit particles from a face of the simulation box, continuously during a
simulation. The particles are added using properties of the specified
mixture and values read from an input file that can override those
properties. The input file can thus be used to create an influx of
particles that varies spatially over the surface of the <em>face</em>. This can
be useful, for example, to model an object inserted into a plume flow
where the flow has spatially varying properties. If invoked every
timestep, this fix creates a continuous influx of particles thru the
face.</p>
<p>The properties of the added particles are determined by the mixture with
ID <em>mix-ID</em> and the input file. Together they set the number and species
of added particles, as well as their streaming velocity, thermal
temperature, and internal energy modes. Settings for a subsonic pressure
boundary condition is also allowed. The details are explained below.</p>
<p>Only one face of the simulation box can be specified via the <em>face</em>
argument. The 6 possible faces are <em>xlo</em>, <em>xhi</em>, <em>ylo</em>, <em>yhi</em>, <em>zlo</em>, or
<em>zhi</em>. This command can be used multiple times to add particles on
multiple faces.</p>
<p>On each insertion timestep, each grid cell with a face touching the
specified boundary <em>face</em> performs the following computations to add
particles. The particles are added at the beginning of the SPARTA
timestep.</p>
<p>The molecular flux across a grid cell face per unit time is given by
equation 4.22 of <a class="reference external" href="#Bird94">(Bird94)</a>. The number of particles <em>M</em> to
add on a particular grid cell face is based on this flux and additional
global, flow, and cell face properties:</p>
<ul class="simple">
<li><p>global property: <em>fnum</em> ratio as specified by the
<a class="reference external" href="global.html">global</a> command</p></li>
<li><p>flow properties: number density, streaming velocity, and thermal
temperature</p></li>
<li><p>cell face properties: area of face and its orientation relative to
the streaming velocity</p></li>
</ul>
<p>The flow properties are defined for the specified mixture via the
<a class="reference external" href="mixture.html">mixture</a> command. Any or all them can be overridden by
values in the input data file, which affect individual grid cells as
described below.</p>
<p>If <em>M</em> has a fractional value, e.g. 12.5, then 12 particles are added,
and a 13th depending on the value of a random number. Each particle is
added at a random location on the grid cell face. The particle species
is chosen randomly in accord with the <em>frac</em> settings of the collection
of species in the mixture, as set by the <a class="reference external" href="mixture.html">mixture</a>
command. These can also be overridden by spatially varying number
fraction values in the input data file, as described below.</p>
<p>The velocity of the particle is set to the sum of the streaming velocity
and a thermal velocity sampled from the thermal temperature. The
internal energy modes of the particle are determined by the <em>trot</em> and
<em>tvib</em> settings and the <em>rotate</em> and <em>vibrate</em> options of the
<a class="reference external" href="collide_modify.html">collide_modify</a> command. Note that if the
<a class="reference external" href="collide.html">collide</a> command has not been specified (free
molecular flow), then no rotational or vibrational energy will be
assigned to created particles.</p>
<p>If the final particle velocity is not directed “into” the grid cell,
then the velocity sampling procedure is repeated until it is. This
insures that all added particles enter the simulation domain, as
desired.</p>
<p>The first timestep that added particles are advected, they move for a
random fraction of the timestep. This insures a continuous flow field of
particles entering the simulation box.</p>
<hr class="docutils" />
<p>For 3d simulations, the input data file defines a 2d mesh of data points
which conceptually overlays some portion or all of the specified face of
the simulation box. For a 2d simulation, a 1d mesh is defined. The mesh
is topologically regular, but can have uniform or non-uniform spacing in
each of its two or one dimensions (for 3d or 2d problems). One or more
values can be defined at every mesh point, which override any of the
mixture settings defined by the <a class="reference external" href="mixture.html">mixture</a> command.
These are the flow properties discussed above (number density, streaming
velocity, and thermal temperature), as well as the number fraction of
any species in the mixture. Any value not defined in the input data file
defaults to the mixture value.</p>
<p>For 3d simulations, a 2d mesh is defined in the file using I,J indices.
(The 1d mesh for 2d simulations is described below). I and J map to any
of the simulation box faces in this manner. A simulation box face has
two varying dimensions (e.g. ylo face = x and z dimensions). The I index
in the file corresponds to the “lowest” of these dimensions, where x &lt; y
&lt; z. The J index in the file corresponds to the higher. Thus for face
ylo, I = x and J = z. A low I or J value corresponds to a low x or z
value, regardless of whether the mapping is to the ylo or yhi face. A 1d
mesh for a 2d simulation is defined in an analogous manner, e.g. for
face xlo, I = y.</p>
<p>For a 3d simulation, interpolation from values on the 2d mesh to any
grid cell face that is on the corresponding simulation box face is done
in the following manner. There are 3 cases to consider.</p>
<p>(a) For a grid cell face that is entirely inside the area defined by the
file mesh, the centroid (center point) of the grid cell face is
surrounded geometrically by 4 file mesh points. The 4 values defined on
those 4 file points are averaged in a weighted manner using bilinear
interpolation (described below) to determine the value for the grid cell
face. This value is then used for the calculation described above for
<em>M</em> = the number of particles to add on the cell face as well as the
properties of the added particles.</p>
<p>(b) For a grid cell face that is entirely outside the area defined by
the file mesh, no particles are added in that grid cell.</p>
<p>(c) For a grid cell face that partially overlaps the area defined by the
file mesh, the extent of the overlap is computed. The centroid (center
point) of the overlap area is surrounded geometrically by 4 file mesh
points. The values for those 4 points are used as in (a) above to
determine properties of particles added in that grid cell. Note that the
area of insertion, used to calculate <em>M</em>, is the overlap area, which is
smaller than the grid cell face area. Also, particles are only added
within the overlap area of the grid cell face.</p>
<p>For a 2d simulation, the 3 cases are similar, except for (a) and (c) the
centroid is the midpoint of a line segment, the centroid is surrounded
by 2 file mesh points, and linear interpolation (described below) is
performed to determine the value for the grid face.</p>
<hr class="docutils" />
<p>The format of the input data file is a series of one or more sections,
defined as follows (without the parenthesized comments). Note that one
file can contain many sections, each with a different set of tabulated
values. The sections can be a mix of 2d and 3d formats. SPARTA reads the
file section by section, skipping sections with non-matching boundary
IDs, until it finds one that matches the specified boundary-ID. The
lines that follow must be in this order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># plume ABC info           (one or more comment or blank lines)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PLUME_ABC</span>                  <span class="p">(</span><span class="n">boundary</span><span class="o">-</span><span class="n">ID</span> <span class="ow">is</span> <span class="n">first</span> <span class="n">word</span> <span class="n">on</span> <span class="n">line</span><span class="p">)</span>
<span class="n">NIJ</span> <span class="mi">4</span> <span class="mi">10</span>                   <span class="p">(</span><span class="n">mesh</span> <span class="n">size</span><span class="p">:</span> <span class="n">Ni</span> <span class="n">by</span> <span class="n">Nj</span><span class="p">)</span>
<span class="n">NV</span> <span class="mi">3</span>                       <span class="p">(</span><span class="n">Nv</span> <span class="o">=</span> <span class="n">number</span> <span class="n">of</span> <span class="n">values</span> <span class="n">per</span> <span class="n">mesh</span> <span class="n">point</span><span class="p">)</span>
<span class="n">VALUES</span> <span class="n">nrho</span> <span class="n">temp</span> <span class="n">Ar</span>        <span class="p">(</span><span class="nb">list</span> <span class="n">of</span> <span class="n">Nv</span> <span class="n">values</span> <span class="n">per</span> <span class="n">mesh</span> <span class="n">point</span><span class="p">)</span>
<span class="n">IMESH</span> <span class="mf">0.0</span> <span class="mf">0.3</span> <span class="mf">0.9</span> <span class="mf">1.0</span>      <span class="p">(</span><span class="n">mesh</span> <span class="n">coordinates</span> <span class="ow">in</span> <span class="n">I</span> <span class="n">direction</span><span class="p">)</span>
<span class="n">JMESH</span> <span class="o">...</span>                  <span class="p">(</span><span class="n">mesh</span> <span class="n">coordinates</span> <span class="ow">in</span> <span class="n">J</span> <span class="n">direction</span><span class="p">)</span>
                           <span class="p">(</span><span class="n">blank</span><span class="p">)</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mf">1.0</span> <span class="mf">300.0</span> <span class="mf">0.5</span>          <span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mf">1.02</span> <span class="mf">310.0</span> <span class="mf">0.5</span>
<span class="o">...</span>
<span class="mi">4</span> <span class="mi">10</span> <span class="mf">3.0</span> <span class="mf">400.0</span> <span class="mf">0.7</span>
</pre></div>
</div>
<p>This format is for a 3d simulation. For a 2d simulation, there are 3
changes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;NIJ 4 10&quot;</span> <span class="ow">is</span> <span class="n">replaced</span> <span class="n">by</span> <span class="s2">&quot;NI 6&quot;</span>
<span class="n">JMESH</span> <span class="n">line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">included</span>
<span class="s2">&quot;I,J,value1,...&quot;</span> <span class="ow">is</span> <span class="n">replaced</span> <span class="n">by</span> <span class="s2">&quot;I,value1,...&quot;</span>
</pre></div>
</div>
<p>A section begins with a non-blank line whose first character is not a
“#”. Blank lines or lines starting with “#” can be used as comments
between sections. The first line begins with a boundary-ID which
identifies the section. The line can contain additional text, but the
initial text must match the boundary-ID specified in the fix
emit/face/file command. Otherwise the section is skipped.</p>
<p>The VALUES line lists Nv keywords. The list of possible keywords is as
follows, along with the meaning of the numeric value specified for the
mesh point:</p>
<ul class="simple">
<li><p>nrho = number density</p></li>
<li><p>vx,vy,vz = 3 components of streaming velocity</p></li>
<li><p>temp = thermal temperature</p></li>
<li><p>trot = rotational temperature</p></li>
<li><p>tvib = vibrational temperature</p></li>
<li><p>press = pressure for subsonic boundary condition</p></li>
<li><p>species = number fraction of any species in the mixture</p></li>
</ul>
<p>The IMESH and JMESH lines must list values that are monotonically
increasing.</p>
<p>Following a blank line, the next N = Ni x Nj lines (or N = Ni lines for
a 2d simulation) list the tabulated values. The format of each line is
I,J followed by Nv values. The N lines can be in any order, but all
unique I,J (or I for 2d) indices must be listed.</p>
<p>Note that if number fractions are specified for one or more species in
the mixture, then they override number fraction values for the mixture
itself, as set by the <a class="reference external" href="mixture.html">mixture</a> command. However, for
each grid cell, the rule that the number fraction of all species in the
mixture must sum to 1.0 is enforced, just as it is for the mixture. This
means that number fractions of species not specified in the file or in
the mixture may be reset (for that grid cell) to insure the sum = 1.0,
as explained on the <a class="reference external" href="mixture.html">mixture</a> command doc page. If this
cannot be done, an error will be generated.</p>
<p>If the <em>press</em> keyword is used, this means a subsonic pressure boundary
condition is used for the face, similar to how the <em>subsonic</em> keyword is
used for the <a class="reference external" href="fix_emit_face.html">fix emit/face</a> command. If just the
<em>press</em> keyword is specified, but not the <em>temp</em> keyword, then it is
similar to the “subsonic press NULL” setting for the <a class="reference external" href="fix_emit_face.html">fix
emit/face</a> command. If both keywords are used it
is similar to the “subsonic press temp” setting for the <a class="reference external" href="fix_emit_face.html">fix
emit/face</a> command. The difference with this
command is that both the <em>press</em> and <em>temp</em> values can be vary spatially
across the box face, like the other keyword values.</p>
<p>The subsonic pressure boundary condition is uses the method of Fang and
Liou <a class="reference external" href="#Fang02">(Fang02)</a> to determine the number of particles to
insert in each grid cell on the emitting face(s). They used the method
of characteristics to calculate the mean properties of the incoming
molecular flux, so that the prescribed pressure condition is achieved.
These properties are then applied to calculate the molecular flux across
a grid cell face per unit time, as given by equation 4.22 of
<a class="reference external" href="#Bird94">(Bird94)</a>.</p>
<p>As explained above the input data file can specify both the pressure and
temperature at the boundary or just the pressure. If specified, the
temperature must be &gt; 0.0. Currently, instantaneous values for the
density, temperature, and stream velocity of particles in the cells
adjacent to the boundary face(s) are computed and used to determine the
properties of inserted particles on each timestep.</p>
<p>IMPORTANT NOTE: Caution must be exercised when using the subsonic
boundary condition without specifying an inlet temperature. In this case
the code tries to estimate the temperature of the flow from the
properties of the particles in the domain. If the domain contains few
particles per cell it may lead to spurious results. This boundary
condition is meant more for an outlet than an inlet boundary condition,
and performs well in cases where the cells are adequately populated.</p>
<p>IMPORTANT NOTE: When using a subsonic prsesure boundary condition, you
should also use an appropriate boundary collision or chemistry model via
the <a class="reference external" href="boundary.htmo">boundary</a> or <a class="reference external" href="bound_modify.html">bound_modify</a>
or <a class="reference external" href="surf_collide.html">surf_collide</a> or
<a class="reference external" href="surf_react.html">surf_react</a> commands, so that particles hitting the
surface disappear as if they were exiting the simulation domain. That is
necessary to produce the correct subsonic conditions that the particle
insertions due to this command are trying to achieve.</p>
<hr class="docutils" />
<p>For 3d simulations, bilinear interpolation from the 2d mesh of values
specified in the file is performed using this equation to calculate the
value at the centroid point (i,j) in the grid cell face:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">area</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span><span class="n">j1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i2</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">j2</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">i2</span><span class="p">,</span><span class="n">j1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">i1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">j2</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span>
                   <span class="n">f</span><span class="p">(</span><span class="n">i2</span><span class="p">,</span><span class="n">j2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">i1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">j1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span><span class="n">j2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i2</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">j1</span><span class="p">))</span>
</pre></div>
</div>
<p>where the 4 surrounding file mesh points are (i1,j1), (i2,j1), (i2,j2),
and (i1,j2). The 4 f() values on the right-hand side are the values
defined at the file mesh points. The sum is normalized by the area of
the overlap between the grid cell face and file mesh.</p>
<p>For 2d simulations, linear interpolation from the 1d mesh of values
specified in the file is performed using this equation to calculate the
value at the centroid poitn (i) in the grid cell line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">length</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i2</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">i1</span><span class="p">)</span>
     <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">i1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">i2</span> <span class="o">-</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">i1</span><span class="p">))</span>
</pre></div>
</div>
<p>where the 2 surrounding file mesh points are (i1) and (i2). The 2 f()
values on the right-hand side are the values defined at the file mesh
points. The sum is normalized by the length of the overlap between the
grid cell line and file mesh.</p>
<hr class="docutils" />
<p>The <em>frac</em> keyword can alter how many particles are added, which can be
useful for debugging purposes. If <em>frac</em> is set to 1.0 (the default)
then the number of particles added is the sum of the <em>M</em> values computed
for each grid cell that overlaps with the mesh defined in the file, as
described above. If <em>frac</em> &lt; 1.0 then <em>M</em> is scaled by frac to determine
the number of particles added in each grid cell. Thus a simulation with
less particles can easily be run to test if it is setup correctly.</p>
<p>The <em>nevery</em> keyword determines how often particles are added. If
<em>Nstep</em> &gt; 1, this may give a non-continuous, clumpy distribution in the
inlet flow field.</p>
<p>The <em>perspecies</em> keyword determines how the species of each added
particle is randomly determined. This has an effect on the statistical
properties of added particles.</p>
<p>If <em>perspecies</em> is set to <em>yes</em>, then a target insertion number <em>M</em> in a
grid cell is calculated for each species, which is a function of the
relative number fraction of the species, as set by the <a class="reference external" href="mixture.html">mixture
nfrac</a> command. If <em>M</em> has a fractional value, e.g.
12.5, then 12 particles of that species will always be added, and a 13th
depending on the value of a random number.</p>
<p>If <em>perspecies</em> is set to <em>no</em>, then a single target insertion number
<em>M</em> in a grid cell is calculated for all the species. Each time a
particle is added, a random number is used to choose the species of the
particle, based on the relative number fractions of all the species in
the mixture. As before, if <em>M</em> has a fractional value, e.g. 12.5, then
12 particles will always be added, and a 13th depending on the value of
a random number.</p>
<p>Here is a simple example that illustrates the difference between the two
options. Assume a mixture with 2 species, each with a relative number
fraction of 0.5. Assume a particular grid cell adds 10 particles from
that mixture. If <em>perspecies</em> is set to <em>yes</em>, then exactly 5 particles
of each species will be added on every timestep insertions take place.
If <em>perspecies</em> is set to <em>no</em>, then exactly 10 particles will be added
every time and on average there will be 5 particles of each of the two
species. But on one timestep it might be 6 of the first and 4 of the
second. On another timestep it might be 3 of the first and 7 of the
second.</p>
<p>If the <em>region</em> keyword is used, then a particle will only added if its
position is within the specified <em>region-ID</em>. This can be used to only
allow particle insertion on a subset of the boundary face. Note that the
<em>side</em> option for the <a class="reference external" href="region.html">region</a> command can be used to
define whether the inside or outside of the geometric region is
considered to be “in” the region.</p>
<hr class="docutils" />
<p><strong>Restart, output info:</strong></p>
<p>No information about this fix is written to <a class="reference external" href="restart.html">binary restart
files</a>.</p>
<p>This fix computes a global vector of length 2 which can be accessed by
various output commands. The first element of the vector is the total
number of particles added on the most recent insertion step. The second
element is the cummulative total number added since the beginning of the
run. The 2nd value is initialized to zero each time a run is performed.</p>
<p><strong>Restrictions:</strong></p>
<p>Particles cannot be added on periodic faces of the simulation box.
Particles cannot be added on <em>z</em> faces of the simluation box for a 2d
simulation.</p>
<p>Unlike the <a class="reference external" href="fix_emit/face.html">fix emit/face</a> command, no warning is
issued if the specified emission face has an inward normal in a
direction opposing the streaming velocity, as defined by the mixture.
This is because the streaming velocity as defined by the specified
mixture may be overridden by values in the file.</p>
<p>For that grid cell, particles will still be emitted from that face, so
long as a small fraction have a thermal velocity large enough to
overcome the outward streaming velocity, so that their net velocity is
inward. The threshold for this is the thermal velocity for particles
3*sigma from the mean thermal velocity.</p>
<p><strong>Related commands:</strong></p>
<p><a class="reference internal" href="mixture.html#command-mixture"><span class="std std-ref">mixture command</span></a>,
<a class="reference internal" href="create_particles.html#command-create-particles"><span class="std std-ref">create_particles command</span></a>,
<a class="reference internal" href="fix_emit_face.html#command-fix-emit-face"><span class="std std-ref">fix emit/face command</span></a></p>
<p><strong>Default:</strong></p>
<p>The keyword defaults are frac = 1.0, nevery = 1, perspecies = yes,
region = none.</p>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, JF

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>