

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fix emit/surf command &mdash; SPARTA 6 Jul 2020 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/rtd_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SPARTA
          

          
          </a>

          
            
            
              <div class="version">
                6 Jul 2020  (build: 13/07/2020)
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
  
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Section_intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_start.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_commands.html">3. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_packages.html">4. Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_accelerate.html">5. Accelerating SPARTA performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_howto.html">6. How-to discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_example.html">7. Example problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_perf.html">8. Performance &amp; scalability</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_tools.html">9. Additional tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_modify.html">10. Modifying &amp; extending SPARTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_python.html">11. Python interface to SPARTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_errors.html">12. Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_history.html">13. Future and history</a></li>
</ul>

            
          
  <a href= "genindex.html">Index</a>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SPARTA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>fix emit/surf command</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/fix_emit_surf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fix-emit-surf-command">
<span id="command-fix-emit-surf"></span><span id="index-0"></span><h1>fix emit/surf command<a class="headerlink" href="#fix-emit-surf-command" title="Permalink to this headline">¶</a></h1>
<div class="section" id="syntax">
<h2>Syntax:<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span> <span class="n">ID</span> <span class="n">emit</span><span class="o">/</span><span class="n">surf</span> <span class="n">mix</span><span class="o">-</span><span class="n">ID</span> <span class="n">group</span><span class="o">-</span><span class="n">ID</span> <span class="n">keyword</span> <span class="n">value</span> <span class="o">...</span>
</pre></div>
</div>
<ul>
<li><p>ID is documented in <a class="reference internal" href="fix.html#command-fix"><span class="std std-ref">fix</span></a> command</p></li>
<li><p>emit/surf = style name of this fix command</p></li>
<li><p>mix-ID = ID of mixture to use when creating particles</p></li>
<li><p>group-ID = ID of surface group that emits particles</p></li>
<li><p>zero or more keyword/value pairs may be appended</p></li>
<li><p>keyword = <em>n</em> or <em>normal</em> or <em>nevery</em> or <em>perspecies</em> or <em>region</em> or
<em>subsonic</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="n">value</span> <span class="o">=</span> <span class="n">Np</span> <span class="o">=</span> <span class="n">number</span> <span class="n">of</span> <span class="n">particles</span> <span class="n">to</span> <span class="n">create</span>
<span class="n">normal</span> <span class="n">value</span> <span class="o">=</span> <span class="n">yes</span> <span class="ow">or</span> <span class="n">no</span> <span class="o">=</span> <span class="n">emit</span> <span class="n">normal</span> <span class="n">to</span> <span class="n">surface</span> <span class="n">elements</span> <span class="ow">or</span> <span class="k">with</span> <span class="n">streaming</span> <span class="n">velocity</span>
<span class="n">nevery</span> <span class="n">value</span> <span class="o">=</span> <span class="n">Nstep</span> <span class="o">=</span> <span class="n">add</span> <span class="n">particles</span> <span class="n">every</span> <span class="n">this</span> <span class="n">many</span> <span class="n">timesteps</span>
<span class="n">perspecies</span> <span class="n">value</span> <span class="o">=</span> <span class="n">yes</span> <span class="ow">or</span> <span class="n">no</span>
<span class="n">region</span> <span class="n">value</span> <span class="o">=</span> <span class="n">region</span><span class="o">-</span><span class="n">ID</span>
<span class="n">subsonic</span> <span class="n">values</span> <span class="o">=</span> <span class="n">Psub</span> <span class="n">Tsub</span>
  <span class="n">Psub</span> <span class="o">=</span> <span class="n">pressure</span> <span class="n">setting</span> <span class="n">at</span> <span class="n">inflow</span> <span class="n">boundary</span> <span class="p">(</span><span class="n">pressure</span> <span class="n">units</span><span class="p">)</span>
  <span class="n">Tsub</span> <span class="o">=</span> <span class="n">temperature</span> <span class="n">setting</span> <span class="n">at</span> <span class="n">inflow</span> <span class="n">boundary</span><span class="p">,</span> <span class="n">can</span> <span class="n">be</span> <span class="n">NULL</span> <span class="p">(</span><span class="n">temperature</span> <span class="n">units</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="examples">
<h2>Examples:<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span> <span class="ow">in</span> <span class="n">emit</span><span class="o">/</span><span class="n">surf</span> <span class="n">air</span> <span class="nb">all</span>
<span class="n">fix</span> <span class="ow">in</span> <span class="n">emit</span><span class="o">/</span><span class="n">face</span> <span class="n">mymix</span> <span class="n">myPatch</span> <span class="n">region</span> <span class="n">circle</span> <span class="n">normal</span> <span class="n">yes</span>
<span class="n">fix</span> <span class="ow">in</span> <span class="n">emit</span><span class="o">/</span><span class="n">surf</span> <span class="n">air</span> <span class="nb">all</span> <span class="n">subsonic</span> <span class="mf">0.1</span> <span class="mi">300</span>
<span class="n">fix</span> <span class="ow">in</span> <span class="n">emit</span><span class="o">/</span><span class="n">surf</span> <span class="n">air</span> <span class="nb">all</span> <span class="n">subsonic</span> <span class="mf">0.05</span> <span class="n">NULL</span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description:<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Emit particles from a group of surface elements, continuously during a
simulation. If invoked every timestep, this fix creates a continuous
outflux of particles from the surface elements in the group.</p>
<p>The properties of the added particles are determined by the mixture with
ID <em>mix-ID</em>. This sets the number and species of added particles, as
well as their streaming velocity, thermal temperature, and internal
energy modes. The details are explained below.</p>
<p>Which surface elements emit particles is specified by the <em>group-ID</em> for
a surface group, which defines a set of surface elements. The <a class="reference internal" href="group.html#command-group"><span class="std std-ref">group surf</span></a> is used to define surface groups.</p>
<p>On each insertion timestep, each grid cell that overlaps with one or
more emitting surface elements performs the following computations to
add particles for each grid cell/surface element pairing. The particles
are added at the beginning of the SPARTA timestep.</p>
<p>The molecular flux emitted from a surface element per unit time is given
by equation 4.22 of <a class="reference internal" href="surf_collide.html#bird94" id="id1"><span>[Bird94]</span></a>. The number of particles <em>M</em>
to insert on the portion of a surface element that is contained within a
grid cell is based on this flux and additional global, flow, and surface
element properties:</p>
<ul class="simple">
<li><p>global property: <em>fnum</em> ratio as specified by the
<a class="reference internal" href="global.html#command-global"><span class="std std-ref">global</span></a> command</p></li>
<li><p>flow properties: number density, streaming velocity, and thermal
temperature</p></li>
<li><p>surface element properties: portion of surface element area that
overlaps with the grid cell and its orientation relative to the
streaming velocity</p></li>
</ul>
<p>The flow properties are defined for the specified mixture via the
<a class="reference internal" href="mixture.html#command-mixture"><span class="std std-ref">mixture</span></a> command.</p>
<p>If <em>M</em> has a fractional value, e.g. 12.5, then 12 particles are added,
and a 13th depending on the value of a random number. Each particle is
added at a random location within the portion of the surface element
that overlaps with the grid cell. The particle species is chosen
randomly in accord with the <em>frac</em> settings of the collection of species
in the mixture, as set by the <a class="reference internal" href="mixture.html#command-mixture"><span class="std std-ref">mixture</span></a> command.</p>
<p>IMPORTANT NOTE: The preceeding calculation is actually done using
surface element areas associated with <em>weighted</em> cell volumes. Grid
cells can be weighted using the <a class="reference internal" href="global.html#command-global"><span class="std std-ref">global weight</span></a> command.</p>
<p>The velocity of the particle is set to the sum of the streaming velocity
and a thermal velocity sampled from the thermal temperature. The
internal energy modes of the particle are determined by the <em>trot</em> and
<em>tvib</em> settings of the mixture and the <em>rotate</em> and <em>vibrate</em> options of
the <a class="reference internal" href="collide_modify.html#command-collide-modify"><span class="std std-ref">collide_modify</span></a> command. Note that if the
<a class="reference internal" href="collide.html#command-collide"><span class="std std-ref">collide</span></a> command has not been specified (free
molecular flow), then no rotational or vibrational energy will be
assigned to created particles. See the discussion of the <em>normal</em>
keyword below for a way to change the velocity assignment to be oriented
in the direction normal to the surface element, rather than in the
direction of the streaming velocity.</p>
<p>If the final particle velocity is not directed “out of” the surface
element, then the velocity sampling procedure is repeated until it is.
This insures that all added particles emit from the surface element, as
desired.</p>
<p>The first timestep that added particles are advected, they move for a
random fraction of the timestep. This insures a continuous flow field of
particles emitting from each surface element.</p>
<hr class="docutils" />
<p>The <em>n</em> keyword can alter how many particles are added, which can be
useful for debugging purposes. If <em>Np</em> is set to 0, then the number of
added particles is a function of <em>fnum</em>, <em>nrho</em>, and other mixture
settings, as described above. If <em>Np</em> is set to a value &gt; 0, then the
<em>fnum</em> and <em>nrho</em> settings are ignored, and exactly <em>Np</em> particles are
added on each insertion timestep. This is done by dividing <em>Np</em> by the
total number of grid cell/surface element pairs and adding an equal
number of particles per pair.</p>
<p>The <em>normal</em> keyword can be used to alter how velocities are set for
added particles. If <em>normal</em> is set to <em>no</em>, then a particle’s velocity
is set as described above, using the mixture’s streaming velocity
superposed with a thermal velocity sampled from the temperature of the
mixture. Note that the same streaming velocity is used for all emitting
surface elements, regardless of their orientation with respect to the
streaming velocity. If <em>normal</em> is set to <em>yes</em>, then each surface
element is assigned its own “streaming” velocity in the following
manner. The streaming velocity points in the direction of the outward
normal of the surface element, and its magnitude is set to the magnitude
of the mixture’s streaming velocity. A velocity is then assigned to the
particle in the same manner as before. It is assigned the outward
streaming velocity superposed with a thermal velocity sampled fromt he
temperature of the mixture. The effect is that particles effectively
stream outward from each emitting surface element.</p>
<p>The <em>nevery</em> keyword determines how often particles are added. If
<em>Nstep</em> &gt; 1, this may give a non-continuous, clumpy distribution in the
inlet flow field.</p>
<p>The <em>perspecies</em> keyword determines how the species of each added
particle is randomly determined. This has an effect on the statistical
properties of added particles.</p>
<p>If <em>perspecies</em> is set to <em>yes</em>, then a target insertion number <em>M</em> for
a grid cell/surface element pair is calculated for each species, which
is a function of the relative number fraction of the species, as set by
the <a class="reference internal" href="mixture.html#command-mixture"><span class="std std-ref">mixture nfrac</span></a> command. If <em>M</em> has a fractional
value, e.g. 12.5, then 12 particles of that species will always be
added, and a 13th depending on the value of a random number.</p>
<p>If <em>perspecies</em> is set to <em>no</em>, then a single target insertion number
<em>M</em> for a grid cell/surface element pair is calculated for all the
species. Each time a particle is added, a random number is used to
choose the species of the particle, based on the relative number
fractions of all the species in the mixture. As before, if <em>M</em> has a
fractional value, e.g. 12.5, then 12 particles will always be added, and
a 13th depending on the value of a random number.</p>
<p>Here is a simple example that illustrates the difference between the two
options. Assume a mixture with 2 species, each with a relative number
fraction of 0.5. Assume a particular grid cell/surface element pair adds
10 particles from that mixture. If <em>perspecies</em> is set to <em>yes</em>, then
exactly 5 particles of each species will be added on every timestep
insertions take place. If <em>perspecies</em> is set to <em>no</em>, then exactly 10
particles will be added every time and on average there will be 5
particles of each of the two species. But on one timestep it might be 6
of the first and 4 of the second. On another timestep it might be 3 of
the first and 7 of the second.</p>
<p>If the <em>region</em> keyword is used, then a particle will only added if its
position is within the specified <em>region-ID</em>. This can be used to only
allow particle insertion on a subset of the collective area of the
specified group of surface elements. Note that the <em>side</em> option for the
<a class="reference internal" href="region.html#command-region"><span class="std std-ref">region</span></a> command can be used to define whether the
inside or outside of the geometric region is considered to be “in” the
region.</p>
<p>IMPORTANT NOTE: If the <em>region</em> and <em>n</em> keywords are used together, less
than N particles may be added on an insertion timestep. This is because
grid cell/suface element pairs will be candidates for particle
insertion, unless the grid cell is entirely outside the bounding box
that encloses the region. Particles those grid cell/surface element
pairs will attempt to add are included in the count for N, even if some
or all of the particle insertions are rejected due to not being inside
the region.</p>
<p>The <em>subsonic</em> keyword uses the method of Fang and Liou
<a class="reference internal" href="fix_emit_face.html#fang02" id="id2"><span>[Fang02]</span></a> to determine the number of particles to insert in
each grid cell on the emitting face(s). They used the method of
characteristics to calculate the mean properties of the incoming
molecular flux, so that the prescribed pressure condition is achieved.
These properties are then applied to calculate the molecular flux across
a grid cell face per unit time, as given by equation 4.22 of
<a class="reference internal" href="surf_collide.html#bird94" id="id3"><span>[Bird94]</span></a></p>
<p>This keyword allows specification of both the pressure and temperature
at the surface or just the pressure (by specifying the temperature as
NULL). If specified, the temperature must be &gt; 0.0. Currently,
instantaneous values for the density, temperature, and stream velocity
of particles in the cells containing the surface elements are computed
and used to determine the properties of inserted particles on each
timestep.</p>
<p>IMPORTANT NOTE: Caution must be exercised when using the subsonic
boundary condition without specifying an inlet temperature. In this case
the code tries to estimate the temperature of the flow from the
properties of the particles in the domain. If the domain contains few
particles per cell it may lead to spurious results. This boundary
condition is meant more for an outlet than an inlet boundary condition,
and performs well in cases where the cells are adequately populated.</p>
<p>IMPORTANT NOTE: When using this keyword, you should also use an
appropriate surface collision or chemistry model via the
<a class="reference internal" href="surf_collide.html#command-surf-collide"><span class="std std-ref">surf_collide</span></a> or <a class="reference internal" href="surf_react.html#command-surf-react"><span class="std std-ref">surf_react</span></a>
commands, so that particles hitting the surface disappear as if they
were exiting the simulation domain. That is necessary to produce the
correct subsonic conditions that the particle insertions due to this
command are trying to achieve.</p>
<hr class="docutils" />
<p><strong>Restart, output info:</strong></p>
<p>No information about this fix is written to <a class="reference internal" href="restart.html#command-restart"><span class="std std-ref">binary restart files</span></a>.</p>
<p>This fix computes a global vector of length 2 which can be accessed by
various output commands. The first element of the vector is the total
number of particles added on the most recent insertion step. The second
element is the cummulative total number added since the beginning of the
run. The 2nd value is initialized to zero each time a run is performed.</p>
</div>
<div class="section" id="restrictions">
<h2>Restrictions:<a class="headerlink" href="#restrictions" title="Permalink to this headline">¶</a></h2>
<p>A <em>n</em> setting of <em>Np</em> &gt; 0 can only be used with a <em>perspecies</em> setting
of <em>no</em>.</p>
<p>If <em>normal</em> is set to <em>no</em>, which is the default, then unlike the
<a class="reference internal" href="fix_emit_face.html#command-fix-emit-face"><span class="std std-ref">fix emit/face command</span></a>, no warning is issued if a surface
element has an inward normal in a direction opposing the streaming
velocity, as defined by the mixture.</p>
<p>For that surface element, particles will still be emitted, so long as a
small fraction have a thermal velocity large enough to overcome the
outward streaming velocity, so that their net velocity is inward. The
threshold for this is the thermal velocity for particles 3*sigma from
the mean thermal velocity.</p>
</div>
<div class="section" id="related-commands">
<h2>Related commands:<a class="headerlink" href="#related-commands" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="mixture.html#command-mixture"><span class="std std-ref">mixture</span></a>,
<a class="reference internal" href="create_particles.html#command-create-particles"><span class="std std-ref">create_particles</span></a>, <a class="reference internal" href="fix_emit_face.html#command-fix-emit-face"><span class="std std-ref">fix emit/face</span></a></p>
</div>
<div class="section" id="default">
<h2>Default:<a class="headerlink" href="#default" title="Permalink to this headline">¶</a></h2>
<p>The keyword defaults are n = 0, normal = no, nevery = 1, perspecies =
yes, region = none, no subsonic settings.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>