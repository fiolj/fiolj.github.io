

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fix ave/surf command &mdash; SPARTA 6 Jul 2020 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/rtd_overrides.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygm_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SPARTA
          

          
          </a>

          
            
            
              <div class="version">
                6 Jul 2020  (build: 23/07/2020)
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
  
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Section_intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_start.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_commands.html">3. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_packages.html">4. Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_accelerate.html">5. Accelerating SPARTA performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_howto.html">6. How-to discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_example.html">7. Example problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_perf.html">8. Performance &amp; scalability</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_tools.html">9. Additional tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_modify.html">10. Modifying &amp; extending SPARTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_python.html">11. Python interface to SPARTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_errors.html">12. Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_history.html">13. Future and history</a></li>
</ul>

            
          
  <a href= "genindex.html">Index</a>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SPARTA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>fix ave/surf command</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/fix_ave_surf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fix-ave-surf-command">
<span id="command-fix-ave-surf"></span><span id="index-0"></span><h1>fix ave/surf command<a class="headerlink" href="#fix-ave-surf-command" title="Permalink to this headline">¶</a></h1>
<div class="section" id="syntax">
<h2>Syntax:<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-xorg.conf notranslate"><div class="highlight"><pre><span></span><span class="nb">fix</span> <span class="no">ID ave/surf group-ID Nevery Nrepeat Nfreq value1 value2 ... keyword args ...</span>
</pre></div>
</div>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ID</span></code> is documented in <a class="reference internal" href="fix.html#command-fix"><span class="std std-ref">fix</span></a> command</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ave/surf</span></code> = style name of this fix command</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group-ID</span></code> = group ID for which surface elements to perform calculation
on</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nevery</span></code> = use input values every this many timesteps</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nrepeat</span></code> = # of times to use input values for calculating averages</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nfreq</span></code> = calculate averages every this many timesteps zero or more
input values can be listed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> = c_ID, c_ID[i], f_ID, f_ID[i], v_name</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c_ID</span></code> = per-surf vector (or array) calculated by a compute with ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c_ID[I]</span></code> = Ith column of per-surf array calculated by a compute with ID, I can include wildcard (see below)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_ID</span></code> = per-surf vector (or array) calculated by a fix with ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_ID[I]</span></code> = Ith column of per-surf array calculated by a fix with ID, I can include wildcard (see below)</p></li>
</ul>
</li>
<li><p>zero or more keyword/arg pairs may be appended</p>
<p><code class="docutils literal notranslate"><span class="pre">keyword</span> <span class="pre">=</span> <span class="pre">ave</span></code></p>
<ul class="simple">
<li><p>ave args = <a class="reference internal" href="#fix-ave-surf-additional"><span class="std std-ref">one or running</span></a></p>
<ul>
<li><p>one = output a new average value every Nfreq steps</p></li>
<li><p>running = accumulate average continuously</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="examples">
<h2>Examples:<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-xorg.conf notranslate"><div class="highlight"><pre><span></span><span class="nb">fix</span> <span class="no">1 ave/surf all 1 100 100 c_surf ave running</span>
<span class="nb">fix</span> <span class="no">1 ave/surf leftcircle 10 20 1000 c_mine[2]</span>
<span class="nb">fix</span> <span class="no">1 ave/surf leftcircle 10 20 1000 c_mine[*]</span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description:<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Use one or more per-surf vectors as inputs every few timesteps, and
average them surface element by surface element by over longer
timescales, applying appropriate normalization factors. The resulting
per-surf averages can be used by other output commands such as the <a class="reference internal" href="dump.html#command-dump"><span class="std std-ref">dump surf</span></a> command. Only surface elements in the surface group
specified by <em>group-ID</em> are included in the averaging. See the <a class="reference internal" href="group.html#command-group"><span class="std std-ref">group surf</span></a> command for info on how surface elements can be
assigned to surface groups.</p>
<p>Each input value can be the result of a <a class="reference internal" href="compute.html#command-compute"><span class="std std-ref">compute</span></a> or
<a class="reference internal" href="fix.html#command-fix"><span class="std std-ref">fix</span></a>. The compute or fix must produce a per-surf vector or
array, not a global or per-particle or per-grid quantity. If you wish to
time-average global quantities from a compute or fix then see the <a class="reference internal" href="fix_ave_time.html#command-fix-ave-time"><span class="std std-ref">fix ave/time</span></a> command. To time-average per-grid
quantities, see the <a class="reference internal" href="fix_ave_grid.html#command-fix-ave-grid"><span class="std std-ref">fix ave/grid</span></a> command.</p>
<p>Each per-surf value of each input vector is averaged independently.</p>
<p><a class="reference internal" href="compute.html#command-compute"><span class="std std-ref">Computes</span></a> that produce per-surf vectors or arrays are
those which have the word <em>surf</em> in their style name. See the doc pages
for individual <a class="reference internal" href="fix.html#command-fix"><span class="std std-ref">fixes</span></a> to determine which ones produce
per-surf vectors or arrays.</p>
<p>Note that for values from a compute or fix, the bracketed index I can be
specified using a wildcard asterisk with the index to effectively
specify multiple values. This takes the form “*” or “<em>n” or “n</em>” or
“m*n”. If N = the size of the vector (for <em>mode</em> = scalar) or the number
of columns in the array (for <em>mode</em> = vector), then an asterisk with no
numeric values means all indices from 1 to N. A leading asterisk means
all indices from 1 to n (inclusive). A trailing asterisk means all
indices from n to N (inclusive). A middle asterisk means all indices
from m to n (inclusive).</p>
<p>Using a wildcard is the same as if the individual columns of the array
had been listed one by one. E.g. these 2 fix ave/surf commands are
equivalent, since the <a class="reference internal" href="compute_grid.html#command-compute-grid"><span class="std std-ref">compute surf</span></a> command
creates a per-surf array with 4 columns:</p>
<div class="highlight-xorg.conf notranslate"><div class="highlight"><pre><span></span>compute mySurf all all n fx fy fz
fix 1 ave/surf all 10 20 1000 c_mySurf[*]
fix 1 ave/surf all 10 20 1000 c_mySurf[1] c_mySurf[2] &amp;
      c_mySurf[3] c_mySurf[4]
</pre></div>
</div>
<hr class="docutils" />
<p>The <em>Nevery</em>, <em>Nrepeat</em>, and <em>Nfreq</em> arguments specify on what timesteps
the input values will be used in order to contribute to the average. The
final averaged quantities are generated on timesteps that are a multiple
of <em>Nfreq</em>. The average is over <em>Nrepeat</em> quantities, computed in the
preceding portion of the simulation every <em>Nevery</em> timesteps. <em>Nfreq</em>
must be a multiple of <em>Nevery</em> and <em>Nevery</em> must be non-zero even if
<em>Nrepeat</em> is 1. Also, the timesteps contributing to the average value
cannot overlap, i.e. Nfreq &gt; (Nrepeat-1)*Nevery is required.</p>
<p>For example, if Nevery=2, Nrepeat=6, and Nfreq=100, then values on
timesteps 90,92,94,96,98,100 will be used to compute the final average
on timestep 100. Similarly for timesteps 190,192,194,196,198,200 on
timestep 200, etc.</p>
<hr class="docutils" />
<p>If a value begins with <code class="docutils literal notranslate"><span class="pre">c_</span></code>, a compute ID must follow which has been
previously defined in the input script. If no bracketed term is
appended, and the compute calculates a per-surf vector, then the
per-surf vector is used. If <em>c_ID[I]</em> is used, then I must be in the
range from 1-M, which will use the Ith column of the M-column per-surf
array calculated by the compute. See the discussion above for how I can
be specified with a wildcard asterisk to effectively specify multiple
values.</p>
<p>Users can also write code for their own compute styles and <a class="reference internal" href="Section_modify.html#modify"><span class="std std-ref">add them to SPARTA</span></a>.</p>
<p>If a value begins with <code class="docutils literal notranslate"><span class="pre">f_</span></code>, a fix ID must follow which has been
previously defined in the input script. If no bracketed term is
appended, and the fix calculates a per-surf vector, then the per-surf
vector is used. If <em>f_ID[I]</em> is used, then I must be in the range from
1-M, which will use the Ith column of the M-column per-surf array
calculated by the fix. See the discussion above for how I can be
specified with a wildcard asterisk to effectively specify multiple
values.</p>
<p>Note that some fixes only produce their values on certain timesteps,
which must be compatible with <em>Nevery</em>, else an error will result. Users
can also write code for their own fix styles and <a class="reference internal" href="Section_modify.html#modify"><span class="std std-ref">add them to SPARTA</span></a>.</p>
<hr class="docutils" />
<p>For averaging of a value that comes from a compute or fix, normalization
is performed as follows. If the compute or fix is summing over particles
to calculate a per-surf quantity (e.g. pressure or energy flux), this
takes the form of a numerator divided by a denominator. For example, see
the formulas discussed on the <a class="reference internal" href="compute_surf.html#command-compute-surf"><span class="std std-ref">compute surf</span></a> doc
page, where the denominator is 1 (for keyword n), area times dt
(timestep) for the other quantities (press, shx, ke, etc). When this
command averages over a series of timesteps, the numerator and
denominator are summed separately. This means the numerator/denominator
division only takes place when this fix produces output, every Nfreq
timesteps.</p>
<hr class="docutils" />
<p id="fix-ave-surf-additional">Additional optional keywords also affect the operation of this fix.</p>
<p>The <em>ave</em> keyword determines what happens to the accumulation of
statistics every <em>Nfreq</em> timesteps.</p>
<p>If the <em>ave</em> setting is <em>one</em>, then the values produced on timesteps
that are multiples of Nfreq are independent of each other. Normalization
as described above is performed, and all tallies are zeroed before
accumulating over the next <em>Nfreq</em> steps.</p>
<p>If the <em>ave</em> setting is <em>running</em>, then tallies are never zeroed. Thus
the output at any <em>Nfreq</em> timestep is normalized over all previously
accumulated samples since the fix was defined. The tallies can only be
zeroed by deleting the fix via the unfix command, or by re-defining the
fix, or by re-specifying it.</p>
</div>
<hr class="docutils" />
<div class="section" id="restart-output-info">
<h2>Restart, output info:<a class="headerlink" href="#restart-output-info" title="Permalink to this headline">¶</a></h2>
<p>No information about this fix is written to <a class="reference internal" href="restart.html#command-restart"><span class="std std-ref">binary restart files</span></a>.</p>
<p>This fix produces a per-surf vector or array which can be accessed by
various output commands. A vector is produced if only a single quantity
is averaged by this fix. If two or more quantities are averaged, then an
array of values is produced, where the number of columns is the number
of quantities averaged. The per-surf values can only be accessed on
timesteps that are multiples of <em>Nfreq</em> since that is when averaging is
performed.</p>
<p>Surface elements not in the specified <em>group-ID</em> will output zeroes for
all their values.</p>
</div>
<div class="section" id="restrictions">
<h2>Restrictions:<a class="headerlink" href="#restrictions" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>none</p>
</div></blockquote>
</div>
<div class="section" id="related-commands">
<h2>Related commands:<a class="headerlink" href="#related-commands" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="compute.html#command-compute"><span class="std std-ref">compute command</span></a>
<a class="reference internal" href="fix_ave_time.html#command-fix-ave-time"><span class="std std-ref">fix ave/time command</span></a></p>
</div>
<div class="section" id="default">
<h2>Default:<a class="headerlink" href="#default" title="Permalink to this headline">¶</a></h2>
<p>The option defaults are ave = one.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>